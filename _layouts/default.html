<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ page.title }} - {{ site.title }}</title>
    <meta
      name="description"
      content="{{ page.description | default: site.description }}"
    />

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{{ page.title }}" />
    <meta
      property="og:description"
      content="{{ page.description | default: site.description }}"
    />
    <meta property="og:type" content="website" />

    <!-- Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-XXXXXXXXXX");
    </script>

    <!-- A/B Testing Configuration -->
    <script>
      // Simple A/B Testing
      const abTestVariant =
        localStorage.getItem("abTestVariant") ||
        (Math.random() < 0.5 ? "A" : "B");
      localStorage.setItem("abTestVariant", abTestVariant);
      document.documentElement.setAttribute("data-variant", abTestVariant);

      // Track page views
      if (typeof gtag !== "undefined") {
        gtag("event", "page_view", {
          variant: abTestVariant,
          page_title: "{{ page.title }}",
        });
      }
    </script>

    <link
      rel="stylesheet"
      href="{{ '/assets/css/style.css' | relative_url }}"
    />
    <!-- Import Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <!-- Download Resume Button -->
    <style>
      @media screen {
        .print-btn {
          position: fixed;
          bottom: 20px;
          right: 20px;
          background: rgba(57, 255, 20, 0.9);
          border: 2px solid #39ff14;
          color: #0a0e27;
          padding: 12px 20px;
          border-radius: 6px;
          cursor: pointer;
          font-family: "JetBrains Mono", monospace;
          font-weight: 600;
          font-size: 0.9em;
          z-index: 9999;
          transition: all 0.3s ease;
          box-shadow: 0 4px 15px rgba(57, 255, 20, 0.3);
          text-decoration: none;
          display: inline-flex;
          align-items: center;
          gap: 8px;
          animation: pulse-border 2s infinite;
        }

        .print-btn:hover {
          background: #39ff14;
          transform: translateY(-2px);
          box-shadow: 0 6px 20px rgba(57, 255, 20, 0.5);
        }

        .print-btn i {
          margin-right: 0;
        }
      }

      @media print {
        .print-btn {
          display: none !important;
        }
      }
    </style>
  </head>

  <body>
    <!-- Resume Download Button -->
    <a
      href="/assets/downloads/resume.pdf"
      download
      class="print-btn"
      title="Download Resume PDF"
      onclick="if(typeof gtag!=='undefined')gtag('event','resume_download',{'location':'floating_button'});"
    >
      <i class="fas fa-download"></i>
      <span>Download Resume</span>
    </a>

    <div class="container">
      <header>
        <nav>
          <a href="#about" onclick="scrollToSection('about')">
            <i class="fas fa-user"></i>
            <span>About</span>
          </a>
          <a href="#experience" onclick="scrollToSection('experience')">
            <i class="fas fa-briefcase"></i>
            <span>Experience</span>
          </a>
          <a href="#skills" onclick="scrollToSection('skills')">
            <i class="fas fa-code"></i>
            <span>Skills</span>
          </a>
          <a href="#contact" onclick="scrollToSection('contact')">
            <i class="fas fa-envelope"></i>
            <span>Contact</span>
          </a>
        </nav>
      </header>
      <main>
        <section>{{ content }}</section>
      </main>
    </div>

    <!-- Accordion JavaScript -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const accordions = document.querySelectorAll(".accordion-header");

        accordions.forEach(function (accordion) {
          accordion.addEventListener("click", function () {
            const content = this.nextElementSibling;
            const isExpanded = content.classList.contains("expanded");
            const sectionTitle =
              this.querySelector(".accordion-title span")?.textContent ||
              "Unknown";

            // Track accordion clicks
            if (typeof gtag !== "undefined") {
              gtag("event", "accordion_click", {
                section: sectionTitle,
                action: isExpanded ? "closed" : "opened",
              });
            }

            // Close all accordions in the same section
            const allContents = document.querySelectorAll(".accordion-content");
            const allHeaders = document.querySelectorAll(".accordion-header");

            allContents.forEach(function (item) {
              item.classList.remove("expanded");
            });
            allHeaders.forEach(function (header) {
              header.classList.remove("active");
            });

            // Open clicked accordion if it wasn't expanded
            if (!isExpanded) {
              content.classList.add("expanded");
              this.classList.add("active");
            }
          });
        });

        // Track print button clicks
        const printBtn = document.querySelector(".print-btn");
        if (printBtn) {
          printBtn.addEventListener("click", function () {
            if (typeof gtag !== "undefined") {
              gtag("event", "print_button_click", {
                page_title: "{{ page.title }}",
              });
            }
          });
        }

        // Track outbound links
        document.querySelectorAll('a[href^="http"]').forEach(function (link) {
          link.addEventListener("click", function (e) {
            if (typeof gtag !== "undefined") {
              gtag("event", "outbound_link_click", {
                link_url: this.href,
                link_text: this.textContent || this.innerText,
              });
            }
          });
        });

        // Track time on page
        let timeOnPage = Date.now();
        window.addEventListener("beforeunload", function () {
          const duration = Math.round((Date.now() - timeOnPage) / 1000);
          if (typeof gtag !== "undefined") {
            gtag("event", "page_exit", {
              duration: duration,
            });
          }
        });
      });

      // Smooth scroll function
      function scrollToSection(id) {
        const element = document.getElementById(id);
        if (element) {
          element.scrollIntoView({ behavior: "smooth", block: "start" });

          // Track navigation clicks
          if (typeof gtag !== "undefined") {
            gtag("event", "navigation_click", {
              section: id,
            });
          }
        }
      }
    </script>
  </body>
</html>
