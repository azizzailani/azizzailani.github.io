<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ page.title }} - {{ site.title }}</title>
    <meta
      name="description"
      content="{{ page.description | default: site.description }}"
    />

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{{ page.title }}" />
    <meta
      property="og:description"
      content="{{ page.description | default: site.description }}"
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ site.url }}{{ page.url }}" />
    <meta
      property="og:image"
      content="{{ site.url }}/assets/images/og-image.jpg"
    />
    <meta property="og:site_name" content="{{ site.title }}" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="{{ page.title }}" />
    <meta
      name="twitter:description"
      content="{{ page.description | default: site.description }}"
    />
    <meta
      name="twitter:image"
      content="{{ site.url }}/assets/images/twitter-card.jpg"
    />

    <!-- Additional SEO Meta Tags -->
    <meta name="author" content="Abdul Aziz Zailani" />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#667eea" />
    <link rel="canonical" href="{{ site.url }}{{ page.url }}" />

    <!-- Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-XXXXXXXXXX");
    </script>

    <!-- A/B Testing Configuration -->
    <script>
      // Simple A/B Testing
      const abTestVariant =
        localStorage.getItem("abTestVariant") ||
        (Math.random() < 0.5 ? "A" : "B");
      localStorage.setItem("abTestVariant", abTestVariant);
      document.documentElement.setAttribute("data-variant", abTestVariant);

      // Track page views
      if (typeof gtag !== "undefined") {
        gtag("event", "page_view", {
          variant: abTestVariant,
          page_title: "{{ page.title }}",
        });
      }
    </script>

    <link
      rel="stylesheet"
      href="{{ '/assets/css/style.css' | relative_url }}"
    />
    <script
      src="{{ '/assets/js/structured-data.js' | relative_url }}"
      defer
    ></script>
    <!-- Import Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <!-- Download Resume Button -->
    <style>
      @media screen {
        .print-btn {
          position: fixed;
          bottom: 20px;
          right: 20px;
          background: rgba(57, 255, 20, 0.9);
          border: 2px solid #39ff14;
          color: #0a0e27;
          padding: 12px 20px;
          border-radius: 6px;
          cursor: pointer;
          font-family: "JetBrains Mono", monospace;
          font-weight: 600;
          font-size: 0.9em;
          z-index: 9999;
          transition: all 0.3s ease;
          box-shadow: 0 4px 15px rgba(57, 255, 20, 0.3);
          text-decoration: none;
          display: inline-flex;
          align-items: center;
          gap: 8px;
          animation: pulse-border 2s infinite;
        }

        .print-btn:hover {
          background: #39ff14;
          transform: translateY(-2px);
          box-shadow: 0 6px 20px rgba(57, 255, 20, 0.5);
        }

        .print-btn i {
          margin-right: 0;
        }
      }

      @media print {
        .print-btn {
          display: none !important;
        }
      }
    </style>
  </head>

  <body>
    <!-- Abstract Code Symbols Background -->
    <div class="background-code-symbols">
      <div class="code-symbol">{</div>
      <div class="code-symbol">}</div>
      <div class="code-symbol">&lt;/&gt;</div>
      <div class="code-symbol">()</div>
      <div class="code-symbol">[]</div>
      <div class="code-symbol">=&gt;</div>
    </div>

    <!-- Abstract Background Blobs -->
    <div id="blob-1" class="abstract-blob blob-1"></div>
    <div id="blob-2" class="abstract-blob blob-2"></div>
    <div id="blob-3" class="abstract-blob blob-3"></div>
    <div id="blob-4" class="abstract-blob blob-4"></div>

    <!-- Dark Mode Toggle -->
    <button
      class="dark-mode-toggle"
      onclick="toggleDarkMode()"
      title="Toggle Dark Mode"
    >
      <i class="fas fa-moon" id="theme-icon"></i>
    </button>

    <!-- Resume Download Button -->
    <a
      href="/assets/downloads/resume.pdf"
      download
      class="print-btn"
      title="Download Resume PDF"
      onclick="if(typeof gtag!=='undefined')gtag('event','resume_download',{'location':'floating_button'});"
    >
      <i class="fas fa-download"></i>
      <span>Download Resume</span>
    </a>

    <div class="container">
      <header>
        <div style="text-align: center; margin-bottom: 15px">
          <h1 style="font-size: 1.5rem; font-weight: 700; margin: 0">
            <i class="fas fa-code"></i> Abdul Aziz Zailani
          </h1>
          <p style="color: #718096; font-size: 0.9rem; margin-top: 5px">
            Senior DevOps Engineer & SRE
          </p>
        </div>
        <nav>
          <a href="#about" onclick="scrollToSection('about')">
            <i class="fas fa-user"></i>
            <span>About</span>
          </a>
          <a href="#experience" onclick="scrollToSection('experience')">
            <i class="fas fa-briefcase"></i>
            <span>Experience</span>
          </a>
          <a href="#skills" onclick="scrollToSection('skills')">
            <i class="fas fa-code"></i>
            <span>Skills</span>
          </a>
          <a href="#projects" onclick="scrollToSection('projects')">
            <i class="fas fa-rocket"></i>
            <span>Projects</span>
          </a>
          <a href="#blog" onclick="scrollToSection('blog')">
            <i class="fas fa-pen-fancy"></i>
            <span>Blog</span>
          </a>
          <a href="#contact" onclick="scrollToSection('contact')">
            <i class="fas fa-envelope"></i>
            <span>Contact</span>
          </a>
        </nav>
      </header>
      <main>
        <section>{{ content }}</section>
      </main>
    </div>

    <!-- Accordion JavaScript -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const accordions = document.querySelectorAll(".accordion-header");

        accordions.forEach(function (accordion) {
          accordion.addEventListener("click", function () {
            const content = this.nextElementSibling;
            const isExpanded = content.classList.contains("expanded");
            const sectionTitle =
              this.querySelector(".accordion-title span")?.textContent ||
              "Unknown";

            // Track accordion clicks
            if (typeof gtag !== "undefined") {
              gtag("event", "accordion_click", {
                section: sectionTitle,
                action: isExpanded ? "closed" : "opened",
              });
            }

            // Close all accordions in the same section
            const allContents = document.querySelectorAll(".accordion-content");
            const allHeaders = document.querySelectorAll(".accordion-header");

            allContents.forEach(function (item) {
              item.classList.remove("expanded");
            });
            allHeaders.forEach(function (header) {
              header.classList.remove("active");
            });

            // Open clicked accordion if it wasn't expanded
            if (!isExpanded) {
              content.classList.add("expanded");
              this.classList.add("active");
            }
          });
        });

        // Track print button clicks
        const printBtn = document.querySelector(".print-btn");
        if (printBtn) {
          printBtn.addEventListener("click", function () {
            if (typeof gtag !== "undefined") {
              gtag("event", "print_button_click", {
                page_title: "{{ page.title }}",
              });
            }
          });
        }

        // Track outbound links
        document.querySelectorAll('a[href^="http"]').forEach(function (link) {
          link.addEventListener("click", function (e) {
            if (typeof gtag !== "undefined") {
              gtag("event", "outbound_link_click", {
                link_url: this.href,
                link_text: this.textContent || this.innerText,
              });
            }
          });
        });

        // Track time on page
        let timeOnPage = Date.now();
        window.addEventListener("beforeunload", function () {
          const duration = Math.round((Date.now() - timeOnPage) / 1000);
          if (typeof gtag !== "undefined") {
            gtag("event", "page_exit", {
              duration: duration,
            });
          }
        });
      });

      // Smooth scroll function
      function scrollToSection(id) {
        const element = document.getElementById(id);
        if (element) {
          element.scrollIntoView({ behavior: "smooth", block: "start" });

          // Track navigation clicks
          if (typeof gtag !== "undefined") {
            gtag("event", "navigation_click", {
              section: id,
            });
          }
        }
      }

      // Dark Mode Toggle
      function toggleDarkMode() {
        const body = document.body;
        const icon = document.getElementById("theme-icon");

        body.classList.toggle("dark-mode");

        if (body.classList.contains("dark-mode")) {
          icon.classList.remove("fa-moon");
          icon.classList.add("fa-sun");
          localStorage.setItem("darkMode", "enabled");

          // Update blob colors for dark mode
          updateBlobColors("dark");
        } else {
          icon.classList.remove("fa-sun");
          icon.classList.add("fa-moon");
          localStorage.setItem("darkMode", "disabled");

          // Reset blob colors
          updateBlobColors("light");
        }
      }

      // Update abstract blob colors
      function updateBlobColors(mode) {
        const blob1 = document.getElementById("blob-1");
        const blob2 = document.getElementById("blob-2");
        const blob3 = document.getElementById("blob-3");
        const blob4 = document.getElementById("blob-4");

        if (mode === "dark") {
          if (blob1)
            blob1.style.background =
              "radial-gradient(circle, rgba(255, 215, 0, 0.4), rgba(255, 140, 0, 0.2), transparent 70%)";
          if (blob2)
            blob2.style.background =
              "radial-gradient(circle, rgba(255, 215, 0, 0.4), rgba(255, 140, 0, 0.2), transparent 70%)";
          if (blob3)
            blob3.style.background =
              "radial-gradient(circle, rgba(255, 215, 0, 0.35), rgba(255, 140, 0, 0.15), transparent 70%)";
          if (blob4)
            blob4.style.background =
              "linear-gradient(135deg, rgba(255, 215, 0, 0.35), rgba(255, 140, 0, 0.25), rgba(255, 215, 0, 0.2))";
        } else {
          if (blob1)
            blob1.style.background =
              "radial-gradient(circle, rgba(102, 126, 234, 0.6), rgba(102, 126, 234, 0.3), transparent 70%)";
          if (blob2)
            blob2.style.background =
              "radial-gradient(circle, rgba(118, 75, 162, 0.6), rgba(118, 75, 162, 0.3), transparent 70%)";
          if (blob3)
            blob3.style.background =
              "radial-gradient(circle, rgba(102, 126, 234, 0.5), rgba(102, 126, 234, 0.2), transparent 70%)";
          if (blob4)
            blob4.style.background =
              "linear-gradient(135deg, rgba(118, 75, 162, 0.5), rgba(102, 126, 234, 0.4), rgba(118, 75, 162, 0.3))";
        }
      }

      // Apply saved dark mode preference
      document.addEventListener("DOMContentLoaded", function () {
        const savedMode = localStorage.getItem("darkMode");
        const body = document.body;
        const icon = document.getElementById("theme-icon");

        if (savedMode === "enabled") {
          body.classList.add("dark-mode");
          icon.classList.remove("fa-moon");
          icon.classList.add("fa-sun");
        }
      });
    </script>
  </body>
</html>
